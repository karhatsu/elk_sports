- sport_name = t("sport_name.european_sub.#{@sub_sport}")
= content_for(:title, "#{@race.name} - #{sport_name}")
%h2= sport_name
- if @race.competitors.empty?
  .message.message--info= t 'official.result_place.no_competitors_in_series'
- else
  .message.message--info= t('official.result_place.shooting.either_total_or_shots')
  .result-cards
    - @race.competitors.each do |competitor|
      .card
        .card__number= competitor.number
        .card__middle
          .card__name
            = full_name competitor
            %span{id: "status_#{competitor.id}"}
          - unless competitor.no_result_reason
            .card__middle-row
              = form_for([:official, competitor.series, competitor], remote: true, namespace: "c_#{competitor.id}", html: { id: "shots_form_#{competitor.id}", class: 'form form--inline' }) do |f|
                = render partial: 'official/shots/european_sub_sport_shots', locals: { f: f, competitor: competitor, sub_sport: @sub_sport }
                .form__buttons= submit_tag t(:save), onclick: "start_updating(#{competitor.id})", class: 'button button--primary'
        .card__main-value{id: "shots_result_#{competitor.id}"}
          - if competitor.no_result_reason
            = competitor.no_result_reason
          - else
            = competitor.send("european_#{@sub_sport}_score").to_i
.buttons.buttons--nav
  = link_to t(:back_to_official_race_page), official_race_path(@race), class: 'button button--back'
:javascript
  function start_updating(id) {
    $("#status_" + id).removeClass().html('#{image_tag 'spinner.gif'}');
  }
  $('.shots-total-input').change(function() {
    calculateShotsResult($(this))
  });
  $('.shot').change(function() {
    calculateShotsResult($(this))
  });
  function calculateShotsResult(field) {
    const $card = field.closest('.card')
    calculateInternationalRaceShotsResult($card, #{EuropeanSubSport.by_key(@sub_sport).best_shot_value}, #{EuropeanSubSport.by_key(@sub_sport).shot_count})
  }
