<% content_for :title, "#{@race.name} - #{clubs_title(@race)}" %>
<h2><%= clubs_title(@race) %></h2>
<% club_word = (@race.club_level == Race::CLUB_LEVEL_PIIRI ? 'piirejÃ¤' : 'seuroja') %>
<div class="info"><%= t '.info', :club_word => club_word %></div>
<h2><%= t :add %> <%= club_title(@race).downcase %></h2>
<div id="action_error"></div>
<%= form_for([:official, @race, Club.new], :remote => true, :html => {:class => 'club_form'}) do |f| %>
  <div>
    <span class="form_label"><%= f.label :name, :for => 'new_club_name' %></span>
    <%= f.text_field :name, :id => 'new_club_name' %>
  </div>
  <div>
    <span class="form_label"><%= f.label :long_name, :for => 'new_club_long_name' %></span>
    <%= f.text_field :long_name, :id => 'new_club_long_name' %> (<%= t '.long_name_info' %>)
  </div>
  <%= submit_tag "#{t(:add)} #{club_title(@race).downcase}", :id => 'submit' %>
  <span id="spinner"></span>
<% end %>
<% style = (@race.clubs.empty? ? 'display: none;' : '') %>
<% club_word = (@race.club_level == Race::CLUB_LEVEL_PIIRI ? 'piirin' : 'seuran') %>
<div id="current_clubs" style="<%= style %>">
  <h2><%= t '.current' %> <%= clubs_title(@race).downcase %></h2>
  <div class="info"><%= t '.edit_info', :club_word => club_word %></div>
  <div class="section">
    <table id="clubs_table">
      <tr>
        <th><%= t 'attributes.name' %></th>
        <th><%= t 'attributes.long_name' %></th>
        <th><%= t '.competitors' %></th>
        <th>&nbsp;</th>
      </tr>
      <% @race.clubs.each do |club| %>
        <%= render :partial => 'club_row', :locals => { :club => club } %>
      <% end %>
    </table>
  </div>
</div>
<%= javascript_tag do %>
  $("#submit").click(function() {
    $("#spinner").html('<%= image_tag 'spinner.gif' %>');
  });
  $(".club_name_link").live('click', function() {
    $(this).hide();
    $(this).next().show();
  });
  function cancel_edit(id, original_name) {
    $('#club_name_form_' + id + ' #club_name').val(original_name);
    $('#club_name_form_' + id).hide();
    $('#club_name_link_' + id).show();
  }
<% end %>
<hr/>
<%= link_to t(:back_to_official_race_page), official_race_path(@race) %>