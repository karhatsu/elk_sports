%table{cellspacing: 0, border: 1}
  %tr
    %th= t 'attributes.name'
    %th{colspan: 2}= t 'official.relays.index.teams'
    %th{colspan: 2}= t 'attributes.start_time'
    %th{colspan: 2}= t 'official.relays.index.results'
    %th= t :correct_distances
    %th= t 'official.relays.index.relay_finishing'
  - @race.relays.each do |relay|
    %tr
      %td= link_to relay.name, edit_official_race_relay_path(@race, relay)
      %td.center.teams_count
        = relay.relay_teams.count
      %td
        = link_to t('official.relays.index.add_new_team'), edit_official_race_relay_path(@race, relay)
      - if relay.start_time_defined?
        %td= image_tag 'icon_yes.gif'
        %td= relay_start_time_print relay
      - else
        %td{colspan: 2}= link_to t('official.relays.index.set_start_time'), edit_official_race_relay_path(@race, relay)
      - if relay.relay_teams.empty?
        %td{colspan: 4}
          = link_to t('official.relays.index.remove_relay'), official_race_relay_path(@race, relay), method: :delete,
            data: { confirm: t('official.relays.index.remove_relay_confirm') }
      - else
        %td
          - if relay.can_finish?
            = image_tag 'icon_yes.gif'
          - else
            &nbsp;
        %td
          = link_to t('official.relays.index.results_quick_save'), official_relay_relay_quick_saves_path(relay)
        %td.center
          - if relay.relay_correct_estimates.map {|ce| ce.distance}.all?
            = image_tag 'icon_yes.gif'
          - else
            = link_to t('official.relays.index.set_correct_estimates'), edit_official_race_relay_path(@race, relay)
        %td.center
          - if relay.finished?
            = image_tag 'icon_yes.gif'
          - elsif relay.can_finish?
            = button_to t('official.relays.index.finish_relay'), official_relay_finish_relay_path(relay), class: 'button button--primary'
          - else
            = t 'official.relays.index.results_missing'
