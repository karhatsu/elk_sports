<body>
  <div id='page_spinner'><%= image_tag 'page_spinner.gif' %></div>
  <%= render :partial => 'shared/facebook_init' %>
  <%= render :partial => 'shared/env_info' %>
  <% unless ActivationKey.activated? %>
    <%= render :partial => 'shared/offline_limit' %>
  <% end %>
  <div class="header">
    <%= render :partial => 'shared/menu' %>
    <div class="login_and_locale_links">
      <% unless offline? %>
        <%= render :partial => "shared/login_links" %>
      <% end %>
      <%= render :partial => 'shared/locale_links' %>
    </div>
  </div>
  <%= render :partial => 'shared/race_title' %>
  <% if @is_races %>
    <%= render :partial => 'shared/sub_menu' %>
  <% elsif @is_cup %>
    <%= render :partial => 'shared/cup_sub_menu' %>
  <% elsif @is_info %>
    <%= render :partial => 'shared/info_sub_menu' %>
  <% elsif @is_offline_info %>
    <%= render :partial => 'shared/offline_sub_menu' %>
  <% elsif @is_limited_official %>
    <%= render :partial => 'official/limited/shared/sub_menu' %>
  <% elsif @is_official %>
    <%= render :partial => 'official/shared/sub_menu' %>
  <% elsif @is_admin %>
    <%= render :partial => 'admin/shared/sub_menu' %>
  <% end %>
  <div class="middle_section<%= (menu_race or @is_cup_series) ? '' :
         ' middle_section_no_menus' %><%= @is_admin ? ' middle_section_admin' : '' %>">
    <div class="main_content"><%= yield %></div>
    <%= yield :sub_sub_menu %>
  </div>
  <div class="footer">
    <%= render :partial => 'shared/footer' %>
  </div>
  <%= javascript_tag do %>
    $(document).on('page:fetch', function() {
      $('#page_spinner').show();
    });
  <% end %>
</body>
