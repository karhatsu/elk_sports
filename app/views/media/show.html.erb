<%= render :partial => "header" %>
<% results = [] %>
<% @race.series.each do |series| %>
  <% unless series.competitors.empty? %>
    <% series_results = "Sarja #{series.name}: " %>
    <% comp_results = [] %>
    <% series.ordered_competitors(false).each_with_index do |c, i| %>
      <% max_points = c.points if i == 0 %>
      <% next unless i < @competitors_count or c.club_id == params[:club_id].to_i %>
      <% unless c.no_result_reason %>
        <% record = national_record(c, true) if c.points.to_i >= max_points.to_i %>
        <% comp_results << "#{i+1}) #{full_name(c)} #{c.club.name} #{c.points}" +
          "#{" (" + record + ")" unless record.blank? }" %>
      <% end %>
    <% end %>
    <% series_results << comp_results.join(", ") %>
    <% series_results << "." %>
    <% results << series_results %>
  <% end %>
<% end %>
<br/>
<div class="section">
  <%= results.join(" ") %>
</div>
<hr/>
<%= link_to 'Takaisin kilpailun etusivulle', race_path(@race) %>