- unofficials = unofficials_result_rule @series.race
- content_for(:title, "#{@series.race.name} - #{@series.name} - #{series_result_title(@series, unofficials)}")
- if @series.active? && Date.today <= @series.race.end_date
  = render :partial => 'shared/refresh_counter', locals: {competition: @series}
%h2 #{@series.name} - #{series_result_title(@series, unofficials)}
- content_for :sub_sub_menu do
  = render layout: 'menus/series_sub_menu', locals: { race: @series.race, series_id: @series.id } do |series|
    = race_series_path(series.race, series)
= render layout: 'series/series_status', locals: { series: @series } do
  - unless @series.sport.shooting?
    = render partial: 'series/three_sport_race_infos', locals: { series: @series }
  - cache [@series, params[:sort], unofficials, I18n.locale] do
    - if @series.sport.nordic?
      = render partial: 'series/shots_buttons', locals: { series: @series }
      .results--desktop= render partial: 'results/nordic_race_desktop', locals: { series: @series }
      .results--mobile= render partial: 'results/nordic_race_mobile', locals: { series: @series }
    - elsif @series.sport.european?
      = render partial: 'series/shots_buttons', locals: { series: @series }
      .results--desktop= render partial: 'results/european_race_desktop', locals: { series: @series }
      .results--mobile= render partial: 'results/european_race_mobile', locals: { series: @series }
    - elsif @series.sport.shooting?
      = render partial: 'series/shots_buttons', locals: { series: @series }
      .results--desktop= render partial: 'results/shooting_race_desktop', locals: { series: @series }
      .results--mobile= render partial: 'results/shooting_race_mobile', locals: { series: @series }
    - else
      .results--desktop= render partial: 'results/three_sports_race_desktop', locals: { series: @series }
      .results--mobile= render partial: 'results/three_sports_race_mobile', locals: { series: @series }
  .buttons
    - if @series.has_unofficial_competitors?
      - if unofficials == Series::UNOFFICIALS_INCLUDED_WITH_BEST_TIME
        = link_to t('competitors.index.show_official_results'), race_series_path(@series.race, @series), class: 'button'
      - elsif unofficials == Series::UNOFFICIALS_EXCLUDED
        = link_to t('competitors.index.show_unofficial_results'), race_series_path(@series.race, @series, all_competitors: true), class: 'button'
    = link_to t(:download_results_pdf), race_series_path(@series.race, @series, format: 'pdf', all_competitors: params[:all_competitors]), class: 'button button--pdf'
= render layout: 'menus/series_sub_menu', locals: { race: @series.race, series_id: @series.id, mobile: true } do |series|
  = race_series_path(series.race, series)
.buttons.buttons--nav
  = link_to "#{t(:back_to_page)} #{@series.race.name}", race_path(@series.race), class: 'button button--back'
  - if @series.race.sport.start_list?
    = link_to t(:start_list), race_series_start_list_path(@series.race, @series), class: 'button'
:javascript
  function showShots() {
    $('.shots').addClass('shots--visible')
    $('#show-shots-button').hide()
    $('#hide-shots-button').show()
    history.pushState(null, null, '?shots=true')
  }
  function hideShots() {
    $('.shots').removeClass('shots--visible')
    $('#show-shots-button').show()
    $('#hide-shots-button').hide()
    history.pushState(null, null, '?')
  }
  $(document).ready(function() {
    if(window.location.search == '?shots=true') {
      showShots()
    }
  });
